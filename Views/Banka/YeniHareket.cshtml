@model MuhasebeStokWebApp.Data.Entities.BankaHareket
@{
    ViewData["Title"] = "Yeni Banka Hareketi";
    var cariler = ViewBag.Cariler as List<MuhasebeStokWebApp.Data.Entities.Cari> ?? new List<MuhasebeStokWebApp.Data.Entities.Cari>();
}

<div class="container-fluid py-4">
    <div class="row">
        <div class="col-12">
            <div class="card my-4">
                <div class="card-header p-0 position-relative mt-n4 mx-3 z-index-2">
                    <div class="bg-gradient-primary shadow-primary border-radius-lg pt-4 pb-3">
                        <h6 class="text-white text-capitalize ps-3">Yeni Banka Hareketi Ekle</h6>
                    </div>
                </div>
                <div class="card-body px-0 pb-2">
                    <div class="container">
                        <form asp-action="YeniHareket" method="post">
                            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="input-group input-group-static my-3">
                                        <label asp-for="BankaID" class="ms-0">Banka Hesabı</label>
                                        <select asp-for="BankaID" class="form-control">
                                            <option value="">Banka Seçiniz</option>
                                            @foreach (var banka in ViewBag.Bankalar)
                                            {
                                                <option value="@banka.BankaID">@banka.BankaAdi - @banka.SubeAdi (@banka.ParaBirimi)</option>
                                            }
                                        </select>
                                    </div>
                                    <span asp-validation-for="BankaID" class="text-danger"></span>
                                </div>
                                <div class="col-md-6">
                                    <div class="input-group input-group-static my-3">
                                        <label asp-for="HareketTuru" class="ms-0">Hareket Türü</label>
                                        <select asp-for="HareketTuru" class="form-control">
                                            <option value="">Hareket Türü Seçiniz</option>
                                            @foreach (var hareketTuru in ViewBag.HareketTurleri)
                                            {
                                                <option value="@hareketTuru">@hareketTuru</option>
                                            }
                                        </select>
                                    </div>
                                    <span asp-validation-for="HareketTuru" class="text-danger"></span>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="input-group input-group-outline my-3">
                                        <label asp-for="Tutar" class="form-label"></label>
                                        <input asp-for="Tutar" class="form-control" type="number" step="0.01" min="0" />
                                    </div>
                                    <span asp-validation-for="Tutar" class="text-danger"></span>
                                </div>
                                <div class="col-md-6">
                                    <div class="input-group input-group-outline my-3">
                                        <label asp-for="ReferansNo" class="form-label"></label>
                                        <input asp-for="ReferansNo" class="form-control" />
                                    </div>
                                    <span asp-validation-for="ReferansNo" class="text-danger"></span>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="input-group input-group-static my-3">
                                        <label class="ms-0">Cari</label>
                                        <select name="CariID" class="form-control">
                                            <option value="">Cari Seçiniz</option>
                                            @foreach (var cari in cariler)
                                            {
                                                <option value="@cari.CariID">@cari.CariAdi</option>
                                            }
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="input-group input-group-outline my-3">
                                        <label asp-for="DekontNo" class="form-label"></label>
                                        <input asp-for="DekontNo" class="form-control" />
                                    </div>
                                    <span asp-validation-for="DekontNo" class="text-danger"></span>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="input-group input-group-outline my-3">
                                        <label asp-for="Aciklama" class="form-label"></label>
                                        <textarea asp-for="Aciklama" class="form-control" rows="3"></textarea>
                                    </div>
                                    <span asp-validation-for="Aciklama" class="text-danger"></span>
                                </div>
                            </div>
                            
                            <div class="row karsi-hesap-bilgileri">
                                <div class="col-md-12">
                                    <h6 class="mt-3 mb-2">Karşı Hesap Bilgileri</h6>
                                </div>
                                <div class="col-md-6">
                                    <div class="input-group input-group-outline my-3">
                                        <label asp-for="KarsiUnvan" class="form-label"></label>
                                        <input asp-for="KarsiUnvan" class="form-control" />
                                    </div>
                                    <span asp-validation-for="KarsiUnvan" class="text-danger"></span>
                                </div>
                                <div class="col-md-6">
                                    <div class="input-group input-group-outline my-3">
                                        <label asp-for="KarsiBankaAdi" class="form-label"></label>
                                        <input asp-for="KarsiBankaAdi" class="form-control" />
                                    </div>
                                    <span asp-validation-for="KarsiBankaAdi" class="text-danger"></span>
                                </div>
                                <div class="col-md-6">
                                    <div class="input-group input-group-outline my-3">
                                        <label asp-for="KarsiIBAN" class="form-label"></label>
                                        <input asp-for="KarsiIBAN" class="form-control" />
                                    </div>
                                    <span asp-validation-for="KarsiIBAN" class="text-danger"></span>
                                </div>
                            </div>
                            
                            <!-- ReferansTuru alanını gizli olarak ekleyelim -->
                            <input type="hidden" asp-for="ReferansTuru" />
                            
                            <div class="row">
                                <div class="col-md-12 text-end">
                                    <a asp-action="Index" class="btn btn-outline-secondary">İptal</a>
                                    <button type="submit" class="btn btn-primary">Kaydet</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    
    <script>
        $(document).ready(function() {
            // Hareket türüne göre karşı hesap bilgilerini göster/gizle
            function updateKarsiHesapVisibility() {
                var hareketTuru = $("#HareketTuru").val();
                
                if (hareketTuru === "Para Yatırma" || hareketTuru === "Para Çekme") {
                    $(".karsi-hesap-bilgileri").hide();
                } else {
                    $(".karsi-hesap-bilgileri").show();
                }
                
                // ReferansTuru alanını HareketTuru ile aynı yapalım
                $("#ReferansTuru").val(hareketTuru);
            }
            
            // Sayfa yüklendiğinde çalıştır
            updateKarsiHesapVisibility();
            
            // Hareket türü değiştiğinde çalıştır
            $("#HareketTuru").change(function() {
                updateKarsiHesapVisibility();
            });
        });
    </script>
} 